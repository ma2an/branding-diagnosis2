<!DOCTYPE html>
<html lang="ja">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ–ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°è¨ºæ–­ãƒ„ãƒ¼ãƒ«</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700;900&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans JP', 'Hiragino Kaku Gothic ProN', 'Hiragino Sans', Meiryo, sans-serif;
            line-height: 1.7;
            color: #333333;
            background: #e8e8e8;
            min-height: 100vh;
            padding: 40px 20px;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #e8e8e8 0%, #d5d5d5 50%, #e8e8e8 100%);
            z-index: -1;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            margin-top: 80px;
        }

        .header {
            text-align: center;
            margin-bottom: 60px;
            position: relative;
        }

        .mela-logo {
            width: 300px;
            height: auto;
            margin: 0 auto 30px auto;
            display: block;
            transition: transform 0.3s ease, filter 0.3s ease;
        }

        .mela-logo:hover {
            transform: translateY(-3px);
            filter: drop-shadow(0 10px 25px rgba(230, 0, 0, 0.4));
        }

        .header h1 {
            font-size: clamp(2.5rem, 5vw, 4rem);
            font-weight: 900;
            margin-bottom: 20px;
            letter-spacing: 0.02em;
            color: rgb(227, 52, 47);
            text-shadow: none;
        }

        .header p {
            font-size: 1.1rem;
            color: #666666;
            font-weight: 300;
            letter-spacing: 0.05em;
            line-height: 1.8;
        }

        .diagnosis-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(227, 52, 47, 0.1);
            border-radius: 20px;
            padding: 50px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }

        .diagnosis-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: rgb(227, 52, 47);
        }

        .sheet-info {
            background: rgba(33, 150, 243, 0.1);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            border-left: 4px solid #2196F3;
            border: 1px solid rgba(33, 150, 243, 0.2);
        }

        .sheet-info h4 {
            color: #64B5F6;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .sheet-info p {
            color: #666666;
            margin-bottom: 8px;
            line-height: 1.6;
        }

        .sheet-info code {
            background: rgba(255, 255, 255, 0.1);
            padding: 3px 8px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            color: #333333;
        }

        .user-info {
            background: rgba(227, 52, 47, 0.05);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 40px;
            border: 1px solid rgba(227, 52, 47, 0.2);
        }

        .user-info h3 {
            color: rgb(227, 52, 47);
            margin-bottom: 25px;
            font-size: 1.4rem;
            font-weight: 700;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #333333;
        }

        .form-group input {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid rgba(102, 102, 102, 0.2);
            border-radius: 10px;
            font-size: 1rem;
            background: rgba(255, 255, 255, 0.8);
            color: #333333;
            transition: all 0.3s ease;
        }

        .form-group input:focus {
            outline: none;
            border-color: rgb(227, 52, 47);
            background: rgba(255, 255, 255, 1);
            box-shadow: 0 0 20px rgba(227, 52, 47, 0.2);
        }

        .form-group input::placeholder {
            color: rgba(102, 102, 102, 0.6);
        }

        .fixed-progress {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(232, 232, 232, 0.95);
            backdrop-filter: blur(10px);
            padding: 15px 20px;
            z-index: 1000;
            border-bottom: 1px solid rgba(227, 52, 47, 0.2);
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
            display: none;
        }

        .fixed-progress-content {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .progress-info {
            display: flex;
            align-items: center;
            gap: 20px;
            color: #333333;
            font-weight: 500;
        }

        .questions-remaining {
            font-size: 0.9rem;
            color: #ff0000;
            font-weight: 700;
            background: rgba(255, 0, 0, 0.1);
            padding: 5px 15px;
            border-radius: 20px;
            border: 1px solid rgba(255, 0, 0, 0.3);
        }

        .fixed-progress-bar {
            flex: 1;
            background: rgba(102, 102, 102, 0.2);
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
            position: relative;
            margin: 0 20px;
        }

        .fixed-progress-fill {
            height: 100%;
            background: #ff0000;
            width: 0%;
            transition: width 0.5s ease;
        }

        .progress-percentage {
            font-size: 0.9rem;
            color: #333333;
            font-weight: 700;
            min-width: 45px;
            text-align: right;
        }

        .category {
            margin-bottom: 50px;
        }

        .category-header {
            display: flex;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid rgba(227, 52, 47, 0.3);
        }

        .category-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 20px;
            font-size: 1.6rem;
            color: #ffffff;
            font-weight: 900;
            background: rgb(227, 52, 47);
            box-shadow: 0 10px 30px rgba(227, 52, 47, 0.3);
        }

        .category-title {
            font-size: 2rem;
            font-weight: 900;
            color: #333333;
        }

        .category-subtitle {
            font-size: 0.95rem;
            color: #666666;
            margin-top: 5px;
            font-weight: 300;
        }

        .question {
            margin-bottom: 35px;
        }

        .question-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #333333;
            margin-bottom: 20px;
            position: relative;
            padding-left: 15px;
        }

        .question-title::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 4px;
            height: 20px;
            background: #ff0000;
            border-radius: 2px;
        }

        .option {
            display: block;
            padding: 20px 25px;
            margin-bottom: 12px;
            border: 2px solid rgba(102, 102, 102, 0.2);
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.6);
            cursor: pointer;
            transition: all 0.3s ease;
            color: #333333;
            font-weight: 400;
        }

        .option:hover {
            border-color: #ff0000;
            background: rgba(255, 0, 0, 0.1);
            transform: translateX(8px);
        }

        .option input[type="radio"] {
            margin-right: 15px;
            transform: scale(1.3);
            accent-color: #ff0000;
        }

        .option.selected {
            border-color: #ff0000;
            background: #ff0000;
            color: #ffffff;
            transform: translateX(12px);
            box-shadow: 0 10px 30px rgba(255, 0, 0, 0.3);
        }

        .calculate-btn {
            background: rgb(227, 52, 47);
            color: #ffffff;
            border: none;
            padding: 20px 50px;
            font-size: 1.3rem;
            font-weight: 700;
            border-radius: 50px;
            cursor: pointer;
            display: block;
            margin: 40px auto;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(227, 52, 47, 0.3);
        }

        .calculate-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(227, 52, 47, 0.4);
        }

        .calculate-btn:disabled {
            background: rgba(102, 102, 102, 0.3);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .result-section {
            display: none;
            margin-top: 40px;
        }

        .result-card {
            background: #ff0000;
            color: #ffffff;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 20px 60px rgba(255, 0, 0, 0.3);
        }

        .total-score {
            font-size: 4rem;
            font-weight: 900;
            margin-bottom: 15px;
        }

        .score-label {
            font-size: 1.3rem;
            opacity: 0.9;
            font-weight: 300;
        }

        /* æ”¹å–„ã•ã‚ŒãŸãƒ‘ã‚¿ãƒ¼ãƒ³æƒ…å ±ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
        .pattern-info {
            background: rgba(255, 255, 255, 0.8);
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 30px;
            text-align: center;
            border: 1px solid rgba(255, 0, 0, 0.1);
        }

        .pattern-display {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 30px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .pattern-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.6);
            border-radius: 15px;
            border: 1px solid rgba(255, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .pattern-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(255, 0, 0, 0.2);
        }

        .pattern-category-label {
            font-size: 1.1rem;
            font-weight: 600;
            color: #666666;
            margin-bottom: 5px;
        }

        .pattern-grade {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            font-weight: 900;
            color: #ffffff;
            position: relative;
        }

        .pattern-grade.grade-A {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            box-shadow: 0 10px 25px rgba(39, 174, 96, 0.4);
        }

        .pattern-grade.grade-B {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            box-shadow: 0 10px 25px rgba(243, 156, 18, 0.4);
        }

        .pattern-grade.grade-C {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            box-shadow: 0 10px 25px rgba(231, 76, 60, 0.4);
        }

        .pattern-grade.grade-D {
            background: linear-gradient(135deg, #95a5a6, #7f8c8d);
            box-shadow: 0 10px 25px rgba(149, 165, 166, 0.4);
        }

        .pattern-category-title {
            font-size: 1rem;
            font-weight: 600;
            color: #333333;
            text-align: center;
        }

        .pattern-overall {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 0, 0, 0.1);
        }

        .pattern-code {
            font-size: 2rem;
            font-weight: 900;
            color: #ff0000;
            margin-bottom: 10px;
            letter-spacing: 0.2em;
        }

        .pattern-description {
            font-size: 1.1rem;
            color: #666666;
            line-height: 1.6;
        }

        .category-results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .category-result {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            border: 1px solid rgba(255, 0, 0, 0.1);
            transition: transform 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .category-result:hover {
            transform: translateY(-5px);
        }

        /* ã‚«ãƒ†ã‚´ãƒªåˆ¥ã®è‰²åˆ†ã‘ */
        .category-result.mi-result::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, #3498db, #2980b9);
        }

        .category-result.vi-result::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, #9b59b6, #8e44ad);
        }

        .category-result.bi-result::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, #e67e22, #d35400);
        }

        .category-result-header {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .category-result-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.4rem;
            font-weight: 900;
            color: #ffffff;
        }

        .mi-result .category-result-icon {
            background: linear-gradient(135deg, #3498db, #2980b9);
            box-shadow: 0 8px 20px rgba(52, 152, 219, 0.3);
        }

        .vi-result .category-result-icon {
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
            box-shadow: 0 8px 20px rgba(155, 89, 182, 0.3);
        }

        .bi-result .category-result-icon {
            background: linear-gradient(135deg, #e67e22, #d35400);
            box-shadow: 0 8px 20px rgba(230, 126, 34, 0.3);
        }

        .category-result-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: #333333;
        }

        .category-score {
            font-size: 3rem;
            font-weight: 900;
            margin-bottom: 15px;
            color: #ff0000;
        }

        .category-grade-display {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin: 15px 0;
        }

        .category-grade {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            font-weight: 900;
            color: #ffffff;
        }

        .category-level {
            font-size: 1.1rem;
            padding: 10px 20px;
            border-radius: 25px;
            display: inline-block;
            font-weight: 600;
        }

        .level-excellent { background: #27ae60; color: white; }
        .level-good { background: #f39c12; color: white; }
        .level-fair { background: #e74c3c; color: white; }
        .level-poor { background: #95a5a6; color: white; }

        .recommendations {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            padding: 40px;
            border-radius: 20px;
            margin-bottom: 30px;
            border: 1px solid rgba(227, 52, 47, 0.1);
        }

        .recommendations h3 {
            color: rgb(227, 52, 47);
            margin-bottom: 25px;
            font-size: 1.6rem;
            font-weight: 700;
        }

        .recommendation-item {
            margin-bottom: 30px;
            padding: 25px;
            background: rgba(227, 52, 47, 0.05);
            border-left: 4px solid rgb(227, 52, 47);
            border-radius: 12px;
            color: #333333;
            line-height: 1.7;
        }

        .recommendation-category {
            display: inline-block;
            background: rgb(227, 52, 47);
            color: #ffffff;
            padding: 8px 20px;
            border-radius: 25px;
            font-weight: 700;
            font-size: 1rem;
            margin-bottom: 15px;
            box-shadow: 0 4px 15px rgba(227, 52, 47, 0.3);
        }

        .recommendation-content {
            margin-top: 15px;
            padding-left: 10px;
            border-left: 2px solid rgba(227, 52, 47, 0.3);
            padding-top: 10px;
        }

        .urgency-critical {
            border-left-color: #ff0000;
            background: rgba(255, 0, 0, 0.15);
            animation: pulse 2s infinite;
        }

        .urgency-high {
            border-left-color: #ff6600;
            background: rgba(255, 102, 0, 0.1);
        }

        .urgency-medium {
            border-left-color: #ffaa00;
            background: rgba(255, 170, 0, 0.1);
        }

        .urgency-low {
            border-left-color: #00aa44;
            background: rgba(0, 170, 68, 0.1);
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(255, 0, 0, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(255, 0, 0, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 0, 0, 0); }
        }

        .loading {
            text-align: center;
            padding: 30px;
            display: none;
            color: #333333;
            font-weight: 500;
        }

        .loading::after {
            content: '';
            display: inline-block;
            width: 25px;
            height: 25px;
            border: 3px solid rgba(227, 52, 47, 0.2);
            border-top: 3px solid rgb(227, 52, 47);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .success-message, .error-message {
            padding: 20px;
            border-radius: 12px;
            margin-top: 25px;
            display: none;
            font-weight: 500;
        }

        .success-message {
            background: rgba(39, 174, 96, 0.2);
            color: #2ecc71;
            border: 1px solid rgba(39, 174, 96, 0.3);
        }

        .error-message {
            background: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
            border: 1px solid rgba(231, 76, 60, 0.3);
        }

        @media (max-width: 768px) {
            body { padding: 20px 10px; }
            .diagnosis-card { padding: 30px 20px; }
            .category-header { flex-direction: column; text-align: center; }
            .category-icon { margin-right: 0; margin-bottom: 15px; }
            .category-results { grid-template-columns: 1fr; }
            .pattern-display { flex-direction: column; gap: 20px; }
            .option { padding: 15px 20px; }
            .calculate-btn { padding: 15px 40px; font-size: 1.1rem; }
        }
    </style>
</head>
<body>
    <div class="fixed-progress" id="fixedProgress">
        <div class="fixed-progress-content">
            <div class="progress-info">
                <div class="progress-text">è¨ºæ–­é€²è¡ŒçŠ¶æ³</div>
                <div class="questions-remaining" id="questionsRemaining">æ®‹ã‚Š 12å•</div>
            </div>
            <div class="fixed-progress-bar">
                <div class="fixed-progress-fill" id="fixedProgressFill"></div>
            </div>
            <div class="progress-percentage" id="progressPercentage">0%</div>
        </div>
    </div>

    <div class="container">
        <div class="header">
            <img src="./mela-logo.svg" alt="mela creative studio" class="mela-logo">
            <h1>ãƒ–ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°è¨ºæ–­ãƒ„ãƒ¼ãƒ«</h1>
            <p>ä¼æ¥­ã®ãƒ–ãƒ©ãƒ³ãƒ‰åŠ›ã‚’ MIãƒ»VIãƒ»BI ã®3ã¤ã®è¦³ç‚¹ã‹ã‚‰ç·åˆçš„ã«è¨ºæ–­ã—ã¾ã™</p>
        </div>

        <div class="diagnosis-card">
            <div class="sheet-info">
                <h4>ğŸ“Š è‡ªå‹•ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆé€£æºã«ã¤ã„ã¦</h4>
                <p>ãƒ»è¨ºæ–­å®Œäº†å¾Œã€å›ç­”ãŒè‡ªå‹•çš„ã«Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«è¨˜éŒ²ã•ã‚Œã¾ã™</p>
                <p>ãƒ»å›ç­”è€…ã®æƒ…å ±ã¨è¨ºæ–­çµæœãŒãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§è“„ç©ã•ã‚Œã¾ã™</p>
                <p>ãƒ»ãƒ‡ãƒ¼ã‚¿ã¯å®‰å…¨ã«æš—å·åŒ–ã•ã‚Œã¦é€ä¿¡ã•ã‚Œã¾ã™</p>
            </div>

            <div class="user-info">
                <h3>å›ç­”è€…æƒ…å ±</h3>
                <div class="form-group">
                    <label for="userName">ãŠåå‰ *</label>
                    <input type="text" id="userName" required placeholder="å±±ç”°å¤ªéƒ">
                </div>
                <div class="form-group">
                    <label for="userCompany">ä¼šç¤¾å</label>
                    <input type="text" id="userCompany" placeholder="æ ªå¼ä¼šç¤¾ã‚µãƒ³ãƒ—ãƒ«">
                </div>
                <div class="form-group">
                    <label for="userEmail">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</label>
                    <input type="email" id="userEmail" placeholder="example@company.com">
                </div>
            </div>

            <!-- MI Section -->
            <div class="category">
                <div class="category-header">
                    <div class="category-icon">MI</div>
                    <div>
                        <div class="category-title">Mind Identity</div>
                        <div class="category-subtitle">ä¼æ¥­ç†å¿µãƒ»æ€æƒ³ãƒ»ä¾¡å€¤è¦³</div>
                    </div>
                </div>

                <div class="question">
                    <div class="question-title">â‘ ä¼æ¥­ç†å¿µã®æœ‰ç„¡</div>
                    <label class="option">
                        <input type="radio" name="mi1" value="9">
                        çµŒå–¶å±¤ã®æ€æƒ³ã‚’åæ˜ ã—ãŸç´å¾—ã„ãä¼æ¥­ç†å¿µãŒã‚ã‚‹
                    </label>
                    <label class="option">
                        <input type="radio" name="mi1" value="5">
                        ä¼æ¥­ç†å¿µã¯ã‚ã‚‹ãŒå®Œå…¨ã«ã—ã£ãã‚Šãã¦ã¯ã„ãªã„
                    </label>
                    <label class="option">
                        <input type="radio" name="mi1" value="3">
                        ä¼æ¥­ç†å¿µã¯ã‚ã‚‹ãŒå…¨ç„¶ã—ã£ãã‚Šãã¦ã„ãªã„
                    </label>
                    <label class="option">
                        <input type="radio" name="mi1" value="0">
                        ä¼æ¥­ç†å¿µãŒãªã„ã€ã¾ãŸã¯ã‚ã‚‹ã‘ã©è¦šãˆã¦ã„ãªã„
                    </label>
                </div>

                <div class="question">
                    <div class="question-title">â‘¡ä¼æ¥­ç†å¿µã¸ã®ç†è§£</div>
                    <label class="option">
                        <input type="radio" name="mi2" value="9">
                        ãƒŸãƒƒã‚·ãƒ§ãƒ³ãƒ»ãƒ“ã‚¸ãƒ§ãƒ³ãƒ»ãƒãƒªãƒ¥ãƒ¼ãªã©ãã‚Œãã‚Œã®å½¹å‰²ã‚’å®Œå…¨ã«ç†è§£ã—ã¦ã„ã‚‹
                    </label>
                    <label class="option">
                        <input type="radio" name="mi2" value="5">
                        ãƒŸãƒƒã‚·ãƒ§ãƒ³ãƒ»ãƒ“ã‚¸ãƒ§ãƒ³ãƒ»ãƒãƒªãƒ¥ãƒ¼ã‚’ä¸€é€šã‚Šæ±ºã‚ã¦ã„ã‚‹ãŒå½¹å‰²ã®ç†è§£ã¯æ›–æ˜§ã§ã‚ã‚‹
                    </label>
                    <label class="option">
                        <input type="radio" name="mi2" value="3">
                        ã‚­ãƒ£ãƒƒãƒã‚³ãƒ”ãƒ¼çš„ãªã‚‚ã®ã¯ã‚ã‚‹ãŒã©ã®å®šç¾©ã«å½“ã¦ã¯ã¾ã‚‹ã®ã‹ã‚ã‹ã‚‰ãªã„
                    </label>
                    <label class="option">
                        <input type="radio" name="mi2" value="0">
                        ä¼æ¥­ç†å¿µãŒãªã„ã€ã¾ãŸã¯ã‚ã‚‹ã‘ã©è¦šãˆã¦ã„ãªã„
                    </label>
                </div>

                <div class="question">
                    <div class="question-title">â‘¢ä¼æ¥­ç†å¿µã®æµ¸é€</div>
                    <label class="option">
                        <input type="radio" name="mi3" value="9">
                        å…¨ã¦ã®ãƒ¡ãƒ³ãƒãƒ¼ãŒç†å¿µã‚’å®Œç’§ã«ç†è§£ãƒ»è¨˜æ†¶ã—ã€ç†å¿µã«æ²¿ã£ãŸæ€è€ƒãƒ»è¡Œå‹•ãŒã§ãã¦ã„ã‚‹
                    </label>
                    <label class="option">
                        <input type="radio" name="mi3" value="5">
                        å½¹å“¡ãªã©ä¸€éƒ¨ã®ãƒ¡ãƒ³ãƒãƒ¼ãŒç†å¿µã‚’ç†è§£ãƒ»è¨˜æ†¶ã—ã€ç†å¿µã«æ²¿ã£ãŸæ€è€ƒãƒ»è¡Œå‹•ã‚’ã—ã¦ã„ã‚‹
                    </label>
                    <label class="option">
                        <input type="radio" name="mi3" value="3">
                        ã»ã¨ã‚“ã©ã®ãƒ¡ãƒ³ãƒãƒ¼ãŒç†å¿µã‚’ç†è§£ã—ã¦ã„ãªã„ã€ã¾ãŸã¯è¨˜æ†¶ã—ã¦ã„ãªã„
                    </label>
                    <label class="option">
                        <input type="radio" name="mi3" value="0">
                        ä¼æ¥­ç†å¿µãŒãªã„ã€ã¾ãŸã¯ã‚ã‚‹ã‘ã©è¦šãˆã¦ã„ãªã„
                    </label>
                </div>

                <div class="question">
                    <div class="question-title">â‘£ç†å¿µã®å¸‚å ´ãƒ»ç¤¾ä¼šã¸ã®æ¥ç¶š</div>
                    <label class="option">
                        <input type="radio" name="mi4" value="9">
                        è‡ªç¤¾ã®ç†å¿µãŒæ˜ç¢ºã«ç¤¾ä¼šèª²é¡Œã‚„å¸‚å ´ã®ãƒ‹ãƒ¼ã‚ºã¨æ¥ç¶šã—ã¦ãŠã‚Šã€ç‹¬è‡ªæ€§ãŒã‚ã‚‹
                    </label>
                    <label class="option">
                        <input type="radio" name="mi4" value="5">
                        ã‚ã‚‹ç¨‹åº¦ã¯ç¤¾ä¼šèª²é¡Œã‚„å¸‚å ´ãƒ‹ãƒ¼ã‚ºã‚’æ„è­˜ã—ã¦ã„ã‚‹ãŒã€ç‹¬è‡ªæ€§ã¯å¼±ã„
                    </label>
                    <label class="option">
                        <input type="radio" name="mi4" value="3">
                        ç†å¿µã¯ã‚ã‚‹ãŒã€ç¤¾ä¼šèª²é¡Œã‚„å¸‚å ´ã¨ã®é–¢é€£ã¯æ„è­˜ã—ã¦ã„ãªã„
                    </label>
                    <label class="option">
                        <input type="radio" name="mi4" value="0">
                        ç†å¿µãŒãªã„ã€ã¾ãŸã¯ã‚ã‚‹ãŒã€å˜ãªã‚‹ã‚¹ãƒ­ãƒ¼ã‚¬ãƒ³ã«ãªã£ã¦ã„ã‚‹
                    </label>
                </div>
            </div>

            <!-- VI Section -->
            <div class="category">
                <div class="category-header">
                    <div class="category-icon">VI</div>
                    <div>
                        <div class="category-title">Visual Identity</div>
                        <div class="category-subtitle">ãƒ­ã‚´ãƒ»ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ»ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«è¡¨ç¾</div>
                    </div>
                </div>

                <div class="question">
                    <div class="question-title">â‘ ãƒ­ã‚´ã«ã¤ã„ã¦</div>
                    <label class="option">
                        <input type="radio" name="vi1" value="8">
                        è‡ªç¤¾ã®ç†å¿µã‚’å®Œç’§ã«ä½“ç¾ã—ãŸãƒ­ã‚´ãŒã‚ã‚‹
                    </label>
                    <label class="option">
                        <input type="radio" name="vi1" value="5">
                        ç´å¾—ã—ã¦ã„ã‚‹ãƒ­ã‚´ã¯ã‚ã‚‹ãŒã€ç†å¿µã‚’ä½“ç¾ã—ã¦ã„ã‚‹ã‹ã¯ã‚ã‹ã‚‰ãªã„
                    </label>
                    <label class="option">
                        <input type="radio" name="vi1" value="3">
                        ã‚ã¾ã‚Šç´å¾—ã¯ã—ã¦ã„ãªã„ä¸€æ—¦ä½œã£ãŸãƒ­ã‚´ãŒã‚ã‚‹
                    </label>
                    <label class="option">
                        <input type="radio" name="vi1" value="0">
                        ãƒ­ã‚´ãŒãªã„ã€ã¾ãŸã¯ã‚ã‚‹ã‘ã©å…¨ãæ°—ã«å…¥ã£ã¦ã„ãªã„
                    </label>
                </div>

                <div class="question">
                    <div class="question-title">â‘¡ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã«ã¤ã„ã¦</div>
                    <label class="option">
                        <input type="radio" name="vi2" value="8">
                        è‡ªç¤¾ã®ç†å¿µã‚„ã‚‰ã—ã•ãŒè¦–è¦šçš„ã«ã‚‚æƒ…å ±çš„ã«ã‚‚ä¼ã‚ã‚‹ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆãŒã‚ã‚‹
                    </label>
                    <label class="option">
                        <input type="radio" name="vi2" value="5">
                        ã‚ã‚‹ç¨‹åº¦ã¾ã¨ã¾ã£ã¦ã„ã‚‹ã‚µã‚¤ãƒˆã¯ã‚ã‚‹ãŒã€ç†å¿µã‚„ã‚‰ã—ã•ãŒè¡¨ç¾ã•ã‚Œã¦ã„ã‚‹ã‹ã‚ã‹ã‚‰ãªã„
                    </label>
                    <label class="option">
                        <input type="radio" name="vi2" value="3">
                        ã‚ã¾ã‚Šç´å¾—ã¯ã—ã¦ã„ãªã„ä¸€æ—¦ä½œã£ãŸã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆãŒã‚ã‚‹
                    </label>
                    <label class="option">
                        <input type="radio" name="vi2" value="0">
                        ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆãŒãªã„ã€ã¾ãŸã¯ã‚ã‚‹ã‘ã©å…¨ãæ°—ã«å…¥ã£ã¦ã„ãªã„
                    </label>
                </div>

                <div class="question">
                    <div class="question-title">â‘¢ãƒ–ãƒ©ãƒ³ãƒ‰ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã®æœ‰ç„¡ã¨æ´»ç”¨çŠ¶æ³</div>
                    <label class="option">
                        <input type="radio" name="vi3" value="8">
                        ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ã«é–¢ã™ã‚‹ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ãŒæ•´å‚™ã•ã‚Œã€ã™ã¹ã¦ã®ãƒ„ãƒ¼ãƒ«ã§å¾¹åº•é‹ç”¨ã•ã‚Œã¦ã„ã‚‹
                    </label>
                    <label class="option">
                        <input type="radio" name="vi3" value="5">
                        ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã¯ã‚ã‚‹ãŒã€å®Ÿå‹™ã§ã®éµå®ˆã¯ä¸€éƒ¨ã«ç•™ã¾ã£ã¦ã„ã‚‹
                    </label>
                    <label class="option">
                        <input type="radio" name="vi3" value="3">
                        ç°¡æ˜“çš„ãªãƒ«ãƒ¼ãƒ«ã¯ã‚ã‚‹ãŒã€å„éƒ¨é–€ã§ãƒãƒ©ãƒãƒ©ã«é‹ç”¨ã•ã‚Œã¦ã„ã‚‹
                    </label>
                    <label class="option">
                        <input type="radio" name="vi3" value="0">
                        ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ãŒãªã„ã€ã¾ãŸã¯å­˜åœ¨ã™ã‚‹ã‹ä¸æ˜ã§ã‚ã‚‹
                    </label>
                </div>

                <div class="question">
                    <div class="question-title">â‘£ãƒ–ãƒ©ãƒ³ãƒ‰è¡¨ç¾ã®æ›´æ–°ãƒ»é€²åŒ–çŠ¶æ³</div>
                    <label class="option">
                        <input type="radio" name="vi4" value="8">
                        ãƒ–ãƒ©ãƒ³ãƒ‰ã®ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«è¡¨ç¾ã¯å®šæœŸçš„ã«è¦‹ç›´ã•ã‚Œã€æ™‚ä»£ã‚„å¸‚å ´ã®å¤‰åŒ–ã«åˆã‚ã›ã¦é€²åŒ–ã—ã¦ã„ã‚‹
                    </label>
                    <label class="option">
                        <input type="radio" name="vi4" value="5">
                        éå»ã«ä¸€åº¦åˆ·æ–°ã—ãŸãŒã€ãã®å¾Œã¯ç‰¹ã«è¦‹ç›´ã—ã¦ã„ãªã„
                    </label>
                    <label class="option">
                        <input type="radio" name="vi4" value="3">
                        é•·å¹´ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ã‚’è¦‹ç›´ã—ã¦ãŠã‚‰ãšã€å¤ã•ã‚’æ„Ÿã˜ã‚‹éƒ¨åˆ†ãŒã‚ã‚‹
                    </label>
                    <label class="option">
                        <input type="radio" name="vi4" value="0">
                        ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ã®åˆ·æ–°ã‚„æ”¹å–„ã‚’è€ƒãˆãŸã“ã¨ãŒãªã„
                    </label>
                </div>
            </div>

            <!-- BI Section -->
            <div class="category">
                <div class="category-header">
                    <div class="category-icon">BI</div>
                    <div>
                        <div class="category-title">Behavior Identity</div>
                        <div class="category-subtitle">è¡Œå‹•ãƒ»çµ„ç¹”ãƒ»äººæãƒ»æ–‡åŒ–</div>
                    </div>
                </div>

                <div class="question">
                    <div class="question-title">â‘ æ¡ç”¨æ´»å‹•ã¨ç†å¿µã®ä¸€è²«æ€§</div>
                    <label class="option">
                        <input type="radio" name="bi1" value="8">
                        æ¡ç”¨åŸºæº–ã«ç†å¿µãŒå®Œå…¨ã«åæ˜ ã•ã‚Œã¦ãŠã‚Šã€äººæè¦ä»¶ã«å…·ä½“çš„ã«è½ã¨ã—è¾¼ã¾ã‚Œã¦ã„ã‚‹
                    </label>
                    <label class="option">
                        <input type="radio" name="bi1" value="5">
                        æ¡ç”¨é¢æ¥ãªã©ã§ç†å¿µã¯ä¼ãˆã¦ã„ã‚‹ãŒã€é¸è€ƒåŸºæº–ã¸ã®åæ˜ ã¯ä¸ååˆ†ã§ã‚ã‚‹
                    </label>
                    <label class="option">
                        <input type="radio" name="bi1" value="3">
                        ç†å¿µã¯å­˜åœ¨ã™ã‚‹ãŒã€æ¡ç”¨æ´»å‹•ã§ç‰¹ã«æ„è­˜ã—ã¦ã„ãªã„
                    </label>
                    <label class="option">
                        <input type="radio" name="bi1" value="0">
                        ç†å¿µãŒãªã„ã€ã¾ãŸã¯å±äººçš„ã ã€‚
                    </label>
                </div>

                <div class="question">
                    <div class="question-title">â‘¡æ¡ç”¨åºƒå ±ã§ã®ãƒ–ãƒ©ãƒ³ãƒ‰ä½“ç¾</div>
                    <label class="option">
                        <input type="radio" name="bi2" value="8">
                        æ¡ç”¨ã‚µã‚¤ãƒˆã‚„æ±‚äººç¥¨ã€é¢è«‡ã§ç†å¿µãŒå¼·ãæ‰“ã¡å‡ºã•ã‚Œã¦ã„ã‚‹
                    </label>
                    <label class="option">
                        <input type="radio" name="bi2" value="5">
                        ä¸€éƒ¨ã®åª’ä½“ã§ã¯ç†å¿µã‚’ä¼ãˆã¦ã„ã‚‹ãŒã€ä¸€è²«æ€§ã¯ãªã„
                    </label>
                    <label class="option">
                        <input type="radio" name="bi2" value="3">
                        æ¡ç”¨åºƒå ±ã§ã¯æ¡ä»¶é¢ãªã©ã®èª¬æ˜ãŒä¸­å¿ƒã§ã€ç†å¿µã¯ä¼ãˆãã‚Œã¦ã„ãªã„
                    </label>
                    <label class="option">
                        <input type="radio" name="bi2" value="0">
                        æ¡ç”¨åºƒå ±ã®æˆ¦ç•¥ãŒãªã„ã€ã¾ãŸã¯å±äººçš„ã ã€‚
                    </label>
                </div>

                <div class="question">
                    <div class="question-title">â‘¢çµ„ç¹”æ§‹ç¯‰ã¨ç†å¿µã®ä¸€è²«æ€§</div>
                    <label class="option">
                        <input type="radio" name="bi3" value="8">
                        ç¤¾å†…åˆ¶åº¦ãƒ»è©•ä¾¡ãƒ»å ±é…¬ã«ç†å¿µãŒåæ˜ ã•ã‚Œã€æµ¸é€æ–½ç­–ã‚‚ç©æ¥µçš„ã«è¡Œã‚ã‚Œã¦ã„ã‚‹
                    </label>
                    <label class="option">
                        <input type="radio" name="bi3" value="5">
                        ç†å¿µã‚’å®šã‚ã¦ã„ã‚‹ãŒã€æµ¸é€ã«å‘ã‘ãŸå–ã‚Šçµ„ã¿ã‚„åˆ¶åº¦ã¸ã®åæ˜ ä¸€éƒ¨ã«ã¨ã©ã¾ã£ã¦ã„ã‚‹
                    </label>
                    <label class="option">
                        <input type="radio" name="bi3" value="3">
                        ç†å¿µã¯å­˜åœ¨ã™ã‚‹ãŒã€ç¤¾å†…ã«æµ¸é€ã—ã¦ã„ãªã„ãƒ»ç†è§£ã•ã‚Œã¦ã„ãªã„
                    </label>
                    <label class="option">
                        <input type="radio" name="bi3" value="0">
                        ç†å¿µã‚„åˆ¶åº¦ãŒãªãã€å„è‡ªã®ä¾¡å€¤è¦³ã«ä»»ã›ãŸè¡Œå‹•ã¨ãªã£ã¦ã„ã‚‹
                    </label>
                </div>

                <div class="question">
                    <div class="question-title">â‘£ãƒªãƒ¼ãƒ€ãƒ¼å±¤ã®ç†å¿µä½“ç¾</div>
                    <label class="option">
                        <input type="radio" name="bi4" value="8">
                        ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆå±¤ãŒç†å¿µã®ä½“ç¾è€…ã¨ãªã‚Šã€æ¨¡ç¯„çš„ãªè¡Œå‹•ã‚’ç¤ºã—ã¦ã„ã‚‹
                    </label>
                    <label class="option">
                        <input type="radio" name="bi4" value="5">
                        ä¸€éƒ¨ã®ãƒªãƒ¼ãƒ€ãƒ¼ã¯ç†å¿µã«åŸºã¥ã„ãŸè¡Œå‹•ã‚’ã—ã¦ã„ã‚‹ãŒã€ã°ã‚‰ã¤ããŒã‚ã‚‹
                    </label>
                    <label class="option">
                        <input type="radio" name="bi4" value="3">
                        ãƒªãƒ¼ãƒ€ãƒ¼å±¤ãŒç†å¿µã‚’ä½“ç¾ã§ãã¦ãŠã‚‰ãšã€éƒ¨ä¸‹ã®æ¨¡ç¯„ã«ãªã£ã¦ã„ãªã„
                    </label>
                    <label class="option">
                        <input type="radio" name="bi4" value="0">
                        ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—è‚²æˆã‚„è¡Œå‹•è¦ç¯„ã«é–¢ã™ã‚‹æ•™è‚²è‡ªä½“ãŒè¡Œã‚ã‚Œã¦ã„ãªã„
                    </label>
                </div>
            </div>

            <button type="button" class="calculate-btn" onclick="calculateResults()">è¨ºæ–­çµæœã‚’è¦‹ã‚‹</button>
            
            <div class="loading" id="loading">
                ãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ä¸­...
            </div>

            <div class="success-message" id="successMessage">
                âœ… è¨ºæ–­çµæœãŒã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«æ­£å¸¸ã«è¨˜éŒ²ã•ã‚Œã¾ã—ãŸï¼
            </div>

            <div class="error-message" id="errorMessage">
                âŒ ãƒ‡ãƒ¼ã‚¿ã®é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ã—ã°ã‚‰ãã—ã¦ã‹ã‚‰å†åº¦ãŠè©¦ã—ãã ã•ã„ã€‚
            </div>

            <div class="result-section" id="resultSection">
                <div class="result-card">
                    <div class="total-score" id="totalScore">0</div>
                    <div class="score-label">ç·åˆã‚¹ã‚³ã‚¢ï¼ˆ100ç‚¹æº€ç‚¹ï¼‰</div>
                </div>

                <div class="pattern-info">
                    <div class="pattern-display">
                        <div class="pattern-item">
                            <div class="pattern-category-label">Mind Identity</div>
                            <div class="pattern-grade grade-A" id="miGrade">A</div>
                            <div class="pattern-category-title">ä¼æ¥­ç†å¿µãƒ»æ€æƒ³ãƒ»ä¾¡å€¤è¦³</div>
                        </div>
                        <div class="pattern-item">
                            <div class="pattern-category-label">Visual Identity</div>
                            <div class="pattern-grade grade-A" id="viGrade">A</div>
                            <div class="pattern-category-title">ãƒ­ã‚´ãƒ»ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ»ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«è¡¨ç¾</div>
                        </div>
                        <div class="pattern-item">
                            <div class="pattern-category-label">Behavior Identity</div>
                            <div class="pattern-grade grade-A" id="biGrade">A</div>
                            <div class="pattern-category-title">è¡Œå‹•ãƒ»çµ„ç¹”ãƒ»äººæãƒ»æ–‡åŒ–</div>
                        </div>
                    </div>
                    <div class="pattern-overall">
                        <div class="pattern-code" id="patternCode">AAA</div>
                        <div class="pattern-description" id="patternDescription">ä¼æ¥­ã‚¿ã‚¤ãƒ—ã®èª¬æ˜ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™</div>
                    </div>
                </div>

                <div class="category-results">
                    <div class="category-result mi-result">
                        <div class="category-result-header">
                            <div class="category-result-icon">MI</div>
                            <div class="category-result-title">Mind Identity</div>
                        </div>
                        <div class="category-score" id="miScore">0</div>
                        <div class="category-grade-display">
                            <div class="category-grade grade-A" id="miDetailGrade">A</div>
                            <div class="category-level" id="miLevel">-</div>
                        </div>
                    </div>
                    <div class="category-result vi-result">
                        <div class="category-result-header">
                            <div class="category-result-icon">VI</div>
                            <div class="category-result-title">Visual Identity</div>
                        </div>
                        <div class="category-score" id="viScore">0</div>
                        <div class="category-grade-display">
                            <div class="category-grade grade-A" id="viDetailGrade">A</div>
                            <div class="category-level" id="viLevel">-</div>
                        </div>
                    </div>
                    <div class="category-result bi-result">
                        <div class="category-result-header">
                            <div class="category-result-icon">BI</div>
                            <div class="category-result-title">Behavior Identity</div>
                        </div>
                        <div class="category-score" id="biScore">0</div>
                        <div class="category-grade-display">
                            <div class="category-grade grade-A" id="biDetailGrade">A</div>
                            <div class="category-level" id="biLevel">-</div>
                        </div>
                    </div>
                </div>

                <div class="recommendations">
                    <h3>æ”¹å–„ææ¡ˆ</h3>
                    <div id="recommendationsList"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Google Apps Script Web App URL - æœ€æ–°ç‰ˆã«æ›´æ–°
        const SPREADSHEET_URL = 'https://script.google.com/macros/s/AKfycbxqKazckO8Fs3aiFO-6oUf8juC_0j7Q2Ox8dL29xaqfqWFTBOcFc_BkfMtnpI_YtU9e/exec';
        
        // è³ªå•ãƒ‡ãƒ¼ã‚¿ã®å®šç¾©
        const questionData = {
            'mi1': {
                category: 'MI',
                question: 'ä¼æ¥­ç†å¿µã®æœ‰ç„¡',
                options: [
                    'ä¼æ¥­ç†å¿µãŒãªã„ã€ã¾ãŸã¯ã‚ã‚‹ã‘ã©è¦šãˆã¦ã„ãªã„',
                    'ä¼æ¥­ç†å¿µã¯ã‚ã‚‹ãŒå…¨ç„¶ã—ã£ãã‚Šãã¦ã„ãªã„',
                    'ä¼æ¥­ç†å¿µã¯ã‚ã‚‹ãŒå®Œå…¨ã«ã—ã£ãã‚Šãã¦ã¯ã„ãªã„',
                    'çµŒå–¶å±¤ã®æ€æƒ³ã‚’åæ˜ ã—ãŸç´å¾—ã„ãä¼æ¥­ç†å¿µãŒã‚ã‚‹'
                ]
            },
            'mi2': {
                category: 'MI',
                question: 'ä¼æ¥­ç†å¿µã¸ã®ç†è§£',
                options: [
                    'ä¼æ¥­ç†å¿µãŒãªã„ã€ã¾ãŸã¯ã‚ã‚‹ã‘ã©è¦šãˆã¦ã„ãªã„',
                    'ã‚­ãƒ£ãƒƒãƒã‚³ãƒ”ãƒ¼çš„ãªã‚‚ã®ã¯ã‚ã‚‹ãŒã©ã®å®šç¾©ã«å½“ã¦ã¯ã¾ã‚‹ã®ã‹ã‚ã‹ã‚‰ãªã„',
                    'ãƒŸãƒƒã‚·ãƒ§ãƒ³ãƒ»ãƒ“ã‚¸ãƒ§ãƒ³ãƒ»ãƒãƒªãƒ¥ãƒ¼ã‚’ä¸€é€šã‚Šæ±ºã‚ã¦ã„ã‚‹ãŒå½¹å‰²ã®ç†è§£ã¯æ›–æ˜§ã§ã‚ã‚‹',
                    'ãƒŸãƒƒã‚·ãƒ§ãƒ³ãƒ»ãƒ“ã‚¸ãƒ§ãƒ³ãƒ»ãƒãƒªãƒ¥ãƒ¼ãªã©ãã‚Œãã‚Œã®å½¹å‰²ã‚’å®Œå…¨ã«ç†è§£ã—ã¦ã„ã‚‹'
                ]
            },
            'mi3': {
                category: 'MI',
                question: 'ä¼æ¥­ç†å¿µã®æµ¸é€',
                options: [
                    'ä¼æ¥­ç†å¿µãŒãªã„ã€ã¾ãŸã¯ã‚ã‚‹ã‘ã©è¦šãˆã¦ã„ãªã„',
                    'ã»ã¨ã‚“ã©ã®ãƒ¡ãƒ³ãƒãƒ¼ãŒç†å¿µã‚’ç†è§£ã—ã¦ã„ãªã„ã€ã¾ãŸã¯è¨˜æ†¶ã—ã¦ã„ãªã„',
                    'å½¹å“¡ãªã©ä¸€éƒ¨ã®ãƒ¡ãƒ³ãƒãƒ¼ãŒç†å¿µã‚’ç†è§£ãƒ»è¨˜æ†¶ã—ã€ç†å¿µã«æ²¿ã£ãŸæ€è€ƒãƒ»è¡Œå‹•ã‚’ã—ã¦ã„ã‚‹',
                    'å…¨ã¦ã®ãƒ¡ãƒ³ãƒãƒ¼ãŒç†å¿µã‚’å®Œç’§ã«ç†è§£ãƒ»è¨˜æ†¶ã—ã€ç†å¿µã«æ²¿ã£ãŸæ€è€ƒãƒ»è¡Œå‹•ãŒã§ãã¦ã„ã‚‹'
                ]
            },
            'mi4': {
                category: 'MI',
                question: 'ç†å¿µã®å¸‚å ´ãƒ»ç¤¾ä¼šã¸ã®æ¥ç¶š',
                options: [
                    'ç†å¿µãŒãªã„ã€ã¾ãŸã¯ã‚ã‚‹ãŒã€å˜ãªã‚‹ã‚¹ãƒ­ãƒ¼ã‚¬ãƒ³ã«ãªã£ã¦ã„ã‚‹',
                    'ç†å¿µã¯ã‚ã‚‹ãŒã€ç¤¾ä¼šèª²é¡Œã‚„å¸‚å ´ã¨ã®é–¢é€£ã¯æ„è­˜ã—ã¦ã„ãªã„',
                    'ã‚ã‚‹ç¨‹åº¦ã¯ç¤¾ä¼šèª²é¡Œã‚„å¸‚å ´ãƒ‹ãƒ¼ã‚ºã‚’æ„è­˜ã—ã¦ã„ã‚‹ãŒã€ç‹¬è‡ªæ€§ã¯å¼±ã„',
                    'è‡ªç¤¾ã®ç†å¿µãŒæ˜ç¢ºã«ç¤¾ä¼šèª²é¡Œã‚„å¸‚å ´ã®ãƒ‹ãƒ¼ã‚ºã¨æ¥ç¶šã—ã¦ãŠã‚Šã€ç‹¬è‡ªæ€§ãŒã‚ã‚‹'
                ]
            },
            'vi1': {
                category: 'VI',
                question: 'ãƒ­ã‚´ã«ã¤ã„ã¦',
                options: [
                    'ãƒ­ã‚´ãŒãªã„ã€ã¾ãŸã¯ã‚ã‚‹ã‘ã©å…¨ãæ°—ã«å…¥ã£ã¦ã„ãªã„',
                    'ã‚ã¾ã‚Šç´å¾—ã¯ã—ã¦ã„ãªã„ä¸€æ—¦ä½œã£ãŸãƒ­ã‚´ãŒã‚ã‚‹',
                    'ç´å¾—ã—ã¦ã„ã‚‹ãƒ­ã‚´ã¯ã‚ã‚‹ãŒã€ç†å¿µã‚’ä½“ç¾ã—ã¦ã„ã‚‹ã‹ã¯ã‚ã‹ã‚‰ãªã„',
                    'è‡ªç¤¾ã®ç†å¿µã‚’å®Œç’§ã«ä½“ç¾ã—ãŸãƒ­ã‚´ãŒã‚ã‚‹'
                ]
            },
            'vi2': {
                category: 'VI',
                question: 'ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã«ã¤ã„ã¦',
                options: [
                    'ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆãŒãªã„ã€ã¾ãŸã¯ã‚ã‚‹ã‘ã©å…¨ãæ°—ã«å…¥ã£ã¦ã„ãªã„',
                    'ã‚ã¾ã‚Šç´å¾—ã¯ã—ã¦ã„ãªã„ä¸€æ—¦ä½œã£ãŸã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆãŒã‚ã‚‹',
                    'ã‚ã‚‹ç¨‹åº¦ã¾ã¨ã¾ã£ã¦ã„ã‚‹ã‚µã‚¤ãƒˆã¯ã‚ã‚‹ãŒã€ç†å¿µã‚„ã‚‰ã—ã•ãŒè¡¨ç¾ã•ã‚Œã¦ã„ã‚‹ã‹ã‚ã‹ã‚‰ãªã„',
                    'è‡ªç¤¾ã®ç†å¿µã‚„ã‚‰ã—ã•ãŒè¦–è¦šçš„ã«ã‚‚æƒ…å ±çš„ã«ã‚‚ä¼ã‚ã‚‹ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆãŒã‚ã‚‹'
                ]
            },
            'vi3': {
                category: 'VI',
                question: 'ãƒ–ãƒ©ãƒ³ãƒ‰ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã®æœ‰ç„¡ã¨æ´»ç”¨çŠ¶æ³',
                options: [
                    'ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ãŒãªã„ã€ã¾ãŸã¯å­˜åœ¨ã™ã‚‹ã‹ä¸æ˜ã§ã‚ã‚‹',
                    'ç°¡æ˜“çš„ãªãƒ«ãƒ¼ãƒ«ã¯ã‚ã‚‹ãŒã€å„éƒ¨é–€ã§ãƒãƒ©ãƒãƒ©ã«é‹ç”¨ã•ã‚Œã¦ã„ã‚‹',
                    'ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã¯ã‚ã‚‹ãŒã€å®Ÿå‹™ã§ã®éµå®ˆã¯ä¸€éƒ¨ã«ç•™ã¾ã£ã¦ã„ã‚‹',
                    'ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ã«é–¢ã™ã‚‹ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ãŒæ•´å‚™ã•ã‚Œã€ã™ã¹ã¦ã®ãƒ„ãƒ¼ãƒ«ã§å¾¹åº•é‹ç”¨ã•ã‚Œã¦ã„ã‚‹'
                ]
            },
            'vi4': {
                category: 'VI',
                question: 'ãƒ–ãƒ©ãƒ³ãƒ‰è¡¨ç¾ã®æ›´æ–°ãƒ»é€²åŒ–çŠ¶æ³',
                options: [
                    'ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ã®åˆ·æ–°ã‚„æ”¹å–„ã‚’è€ƒãˆãŸã“ã¨ãŒãªã„',
                    'é•·å¹´ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ã‚’è¦‹ç›´ã—ã¦ãŠã‚‰ãšã€å¤ã•ã‚’æ„Ÿã˜ã‚‹éƒ¨åˆ†ãŒã‚ã‚‹',
                    'éå»ã«ä¸€åº¦åˆ·æ–°ã—ãŸãŒã€ãã®å¾Œã¯ç‰¹ã«è¦‹ç›´ã—ã¦ã„ãªã„',
                    'ãƒ–ãƒ©ãƒ³ãƒ‰ã®ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«è¡¨ç¾ã¯å®šæœŸçš„ã«è¦‹ç›´ã•ã‚Œã€æ™‚ä»£ã‚„å¸‚å ´ã®å¤‰åŒ–ã«åˆã‚ã›ã¦é€²åŒ–ã—ã¦ã„ã‚‹'
                ]
            },
            'bi1': {
                category: 'BI',
                question: 'æ¡ç”¨æ´»å‹•ã¨ç†å¿µã®ä¸€è²«æ€§',
                options: [
                    'ç†å¿µãŒãªã„ã€ã¾ãŸã¯å±äººçš„ã ã€‚',
                    'ç†å¿µã¯å­˜åœ¨ã™ã‚‹ãŒã€æ¡ç”¨æ´»å‹•ã§ç‰¹ã«æ„è­˜ã—ã¦ã„ãªã„',
                    'æ¡ç”¨é¢æ¥ãªã©ã§ç†å¿µã¯ä¼ãˆã¦ã„ã‚‹ãŒã€é¸è€ƒåŸºæº–ã¸ã®åæ˜ ã¯ä¸ååˆ†ã§ã‚ã‚‹',
                    'æ¡ç”¨åŸºæº–ã«ç†å¿µãŒå®Œå…¨ã«åæ˜ ã•ã‚Œã¦ãŠã‚Šã€äººæè¦ä»¶ã«å…·ä½“çš„ã«è½ã¨ã—è¾¼ã¾ã‚Œã¦ã„ã‚‹'
                ]
            },
            'bi2': {
                category: 'BI',
                question: 'æ¡ç”¨åºƒå ±ã§ã®ãƒ–ãƒ©ãƒ³ãƒ‰ä½“ç¾',
                options: [
                    'æ¡ç”¨åºƒå ±ã®æˆ¦ç•¥ãŒãªã„ã€ã¾ãŸã¯å±äººçš„ã ã€‚',
                    'æ¡ç”¨åºƒå ±ã§ã¯æ¡ä»¶é¢ãªã©ã®èª¬æ˜ãŒä¸­å¿ƒã§ã€ç†å¿µã¯ä¼ãˆãã‚Œã¦ã„ãªã„',
                    'ä¸€éƒ¨ã®åª’ä½“ã§ã¯ç†å¿µã‚’ä¼ãˆã¦ã„ã‚‹ãŒã€ä¸€è²«æ€§ã¯ãªã„',
                    'æ¡ç”¨ã‚µã‚¤ãƒˆã‚„æ±‚äººç¥¨ã€é¢è«‡ã§ç†å¿µãŒå¼·ãæ‰“ã¡å‡ºã•ã‚Œã¦ã„ã‚‹'
                ]
            },
            'bi3': {
                category: 'BI',
                question: 'çµ„ç¹”æ§‹ç¯‰ã¨ç†å¿µã®ä¸€è²«æ€§',
                options: [
                    'ç†å¿µã‚„åˆ¶åº¦ãŒãªãã€å„è‡ªã®ä¾¡å€¤è¦³ã«ä»»ã›ãŸè¡Œå‹•ã¨ãªã£ã¦ã„ã‚‹',
                    'ç†å¿µã¯å­˜åœ¨ã™ã‚‹ãŒã€ç¤¾å†…ã«æµ¸é€ã—ã¦ã„ãªã„ãƒ»ç†è§£ã•ã‚Œã¦ã„ãªã„',
                    'ç†å¿µã‚’å®šã‚ã¦ã„ã‚‹ãŒã€æµ¸é€ã«å‘ã‘ãŸå–ã‚Šçµ„ã¿ã‚„åˆ¶åº¦ã¸ã®åæ˜ ä¸€éƒ¨ã«ã¨ã©ã¾ã£ã¦ã„ã‚‹',
                    'ç¤¾å†…åˆ¶åº¦ãƒ»è©•ä¾¡ãƒ»å ±é…¬ã«ç†å¿µãŒåæ˜ ã•ã‚Œã€æµ¸é€æ–½ç­–ã‚‚ç©æ¥µçš„ã«è¡Œã‚ã‚Œã¦ã„ã‚‹'
                ]
            },
            'bi4': {
                category: 'BI',
                question: 'ãƒªãƒ¼ãƒ€ãƒ¼å±¤ã®ç†å¿µä½“ç¾',
                options: [
                    'ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—è‚²æˆã‚„è¡Œå‹•è¦ç¯„ã«é–¢ã™ã‚‹æ•™è‚²è‡ªä½“ãŒè¡Œã‚ã‚Œã¦ã„ãªã„',
                    'ãƒªãƒ¼ãƒ€ãƒ¼å±¤ãŒç†å¿µã‚’ä½“ç¾ã§ãã¦ãŠã‚‰ãšã€éƒ¨ä¸‹ã®æ¨¡ç¯„ã«ãªã£ã¦ã„ãªã„',
                    'ä¸€éƒ¨ã®ãƒªãƒ¼ãƒ€ãƒ¼ã¯ç†å¿µã«åŸºã¥ã„ãŸè¡Œå‹•ã‚’ã—ã¦ã„ã‚‹ãŒã€ã°ã‚‰ã¤ããŒã‚ã‚‹',
                    'ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆå±¤ãŒç†å¿µã®ä½“ç¾è€…ã¨ãªã‚Šã€æ¨¡ç¯„çš„ãªè¡Œå‹•ã‚’ç¤ºã—ã¦ã„ã‚‹'
                ]
            }
        };

        // è©³ç´°ãªæ”¹å–„ææ¡ˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆçŸ¥è­˜ãƒ™ãƒ¼ã‚¹çµ±åˆç‰ˆï¼‰
        const PATTERN_RECOMMENDATIONS = {
            'AAA': {
                description: 'ãƒ–ãƒ©ãƒ³ãƒ‰å…ˆé€²ä¼æ¥­ãƒ¬ãƒ™ãƒ« - ç†å¿µãƒ»ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ãƒ»çµ„ç¹”ã™ã¹ã¦ãŒå®Œç’§',
                improvements: {
                    mi: '',
                    vi: '',
                    bi: '',
                    general: 'ç¾çŠ¶ç¶­æŒãƒªã‚¹ã‚¯ã‚„å¸‚å ´å¤‰åŒ–ã¸ã®å¯¾å¿œé…ã‚Œã®å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚'
                },
                actions: {
                    mi: '',
                    vi: '',
                    bi: '',
                    general: 'å®šæœŸçš„ãªãƒ–ãƒ©ãƒ³ãƒ‰ç›£æŸ»ã®å®Ÿæ–½ï¼ˆå¹´2å›ï¼‰ã€ç«¶åˆåˆ†æã«ã‚ˆã‚‹å·®åˆ¥åŒ–ãƒã‚¤ãƒ³ãƒˆã®å†ç¢ºèªã€ã‚°ãƒ­ãƒ¼ãƒãƒ«å±•é–‹ã«å‘ã‘ãŸãƒ–ãƒ©ãƒ³ãƒ‰æˆ¦ç•¥ç­–å®šã‚’æ¨å¥¨ã—ã¾ã™ã€‚'
                },
                urgency: 'low'
            }
        };

        // åŸºæœ¬çš„ãªãƒ¬ãƒ™ãƒ«åˆ¥æ”¹å–„ç‚¹ãƒ»ææ¡ˆã®çŸ¥è­˜ãƒ™ãƒ¼ã‚¹
        const KNOWLEDGE_BASE = {
            mi: {
                D: {
                    improvement: 'ä¼æ¥­ç†å¿µãŒç­–å®šã•ã‚Œã¦ã„ãªã„ã€ã¾ãŸã¯å½¢å¼çš„ã™ãã‚‹çŠ¶æ…‹ã§ã™ã€‚ç†å¿µã®å†…å®¹ãŒæŠ½è±¡çš„ã§å¾“æ¥­å“¡ã«ç†è§£ã•ã‚Œã«ããã€ä¼æ¥­ã®å­˜åœ¨æ„ç¾©ã‚„ç¤¾ä¼šçš„ä¾¡å€¤ãŒä¸æ˜ç¢ºã«ãªã£ã¦ã„ã¾ã™ã€‚ã‹ãªã‚Šå±é™ºãªçŠ¶æ…‹ã§ã™ã€‚ç†å¿µãŒãªã„ã¾ã¾ã‚¹ã‚±ãƒ¼ãƒ«ã™ã‚‹ã¨çµ„ç¹”å´©å£Šã‚„äººææµå‡ºã€æ¡ç”¨é›£ã€ãã—ã¦çµæœçš„ã«ç«¶äº‰åŠ›ã®ä½ä¸‹ã«ã¤ãªãŒã‚Šã¾ã™ã€‚ä¼æ¥­ç†å¿µã¯çµ„ç¹”ã®æ ¹ã£ã“ã§ã™ã€‚',
                    action: 'ä¼æ¥­ç†å¿µã®æ˜ç¢ºåŒ–ã‚’æœ€å„ªå…ˆã§å–ã‚Šçµ„ã¿ã¾ã—ã‚‡ã†ã€‚ç­–å®šã«ã‚ãŸã£ã¦ã¯ã€ã¾ãšç¤¾å†…å¤–ã¸ã®èª¿æŸ»ç­‰ã‚’é€šã˜ã¦è‡ªç¤¾ã®ç¾çŠ¶ã‚’å®¢è¦³çš„ã«æŠŠæ¡ã—ãŸã†ãˆã§ã€ãƒ‘ãƒ¼ãƒ‘ã‚¹ã‚’æ¤œè¨ã™ã‚‹ã“ã¨ãŒå¿…è¦ã§ã™ã€‚ã¾ãŸã€çµŒå–¶å±¤ã ã‘ã§æ¤œè¨ã›ãšã€è‹¥æ‰‹ã‚’ä¸­å¿ƒã¨ã—ãŸæœªæ¥ã‚’æ‹…ã†ã‚­ãƒ¼ãƒ‘ãƒ¼ã‚½ãƒ³ã‚’é¸å‡ºã—ã¦å§”å“¡ä¼šã‚’è¨­ç½®ã—ã€åŒãƒ¡ãƒ³ãƒãƒ¼ã‚’æµ¸é€ãƒ»å®šç€ã‚’å›³ã‚‹ä¸»å½¹ï¼ˆä¼é“å¸«ï¼‰ã«ã™ã‚‹ã“ã¨ã§ã€å…¨ç¤¾å“¡ã®ç›®ç·šã‚’å¼•ãä¸Šã’ã€ç´å¾—ã‚’å¾—ã‚‹ã“ã¨ã‚‚é‡è¦ãªãƒã‚¤ãƒ³ãƒˆã§ã™ã€‚'
                },
                C: {
                    improvement: 'ç†å¿µã®æ„å‘³ã‚„èƒŒæ™¯ã¸ã®ç†è§£ä¸è¶³ã€ä¸€æ–¹çš„ãªæŠ¼ã—ä»˜ã‘ã«ã‚ˆã‚‹è…¹è½ã¡ä¸è¶³ãŒè¦‹ã‚‰ã‚Œã¾ã™ã€‚ç†å¿µã¨ã‚µãƒ¼ãƒ“ã‚¹ãŒæ¥ç¶šã•ã‚Œã¦ã„ãªã„å ´åˆã€ç¶ºéº—äº‹ã‚’æ²ã’ã¦ã„ã‚‹ã ã‘ã«ãªã‚Šã¾ã™ã€‚ç†å¿µã¨ã¯èã“ãˆã®ã„ã„ã‚­ãƒ£ãƒƒãƒã‚³ãƒ”ãƒ¼ã§ã¯ãªãã€å®Ÿè¡Œã™ã¹ãæŒ‡é‡ãªã®ã§ã™ã€‚',
                    action: 'ç†å¿µã®æ„å‘³ã‚„èƒŒæ™¯ãŒç†è§£ã•ã‚Œã¦ã„ãªã„å ´åˆã‚‚ã€æµ¸é€ã—ãªã„åŸå› ã¨ãªã‚Šã¾ã™ã€‚è‡ªç¤¾ã®ç†å¿µãŒã©ã®ã‚ˆã†ãªèƒŒæ™¯ã§ç­–å®šã•ã‚ŒãŸã®ã‹ã€ã¾ãŸã€å‰µè¨­è€…ãƒ»çµŒå–¶è€…ã®ã©ã®ã‚ˆã†ãªä¿¡å¿µãŒåæ˜ ã•ã‚Œã¦ã„ã‚‹ã®ã‹ã€å¾“æ¥­å“¡ã«å¯¾ã—ã¦èª¬æ˜ã™ã‚‹æ©Ÿä¼šãŒå¿…è¦ã§ã™ã€‚æ„å‘³ã‚„èƒŒæ™¯ã‚’ç†è§£ã—ã¦åˆã‚ã¦ã€æ™®æ®µã®è¡Œå‹•ã‚„åˆ¤æ–­ã«åæ˜ ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚'
                },
                B: {
                    improvement: 'å…·ä½“çš„ãªæµ¸é€æ–½ç­–ã®æ¬ å¦‚ã€ç¶™ç¶šçš„ãªå–ã‚Šçµ„ã¿ã®ä¸è¶³ã€ä½“ç¾è¡Œå‹•ã®å¯è¦–åŒ–ä¸è¶³ãŒã‚ã‚Šã¾ã™ã€‚ç†å¿µã«æ²¿ã£ãŸæ€è€ƒã¨è¡Œå‹•ã¯ä¼æ¥­æ–‡åŒ–ã‚’ã¤ãã‚‹ãŸã‚ã«å¿…è¦ã§ã™ã€‚å…¨ã¦ã®ãƒ¡ãƒ³ãƒãƒ¼ãŒç†å¿µã‚’ç†è§£ãƒ»å®Ÿè·µã§ãã‚‹ä½“åˆ¶ã‚’æ•´ãˆã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚',
                    action: 'MVVã‚’"æµ¸é€ã•ã›ã‚‹"ã®ã§ã¯ãªãMVVã‚’"ä½“ç¾ã—ãŸè¡Œå‹•ã‚’è¦‹ã¤ã‘ã¦å¯è¦–åŒ–ã™ã‚‹"ã€‚ã¾ãšã¯ã€Œä»Šã‚ã‚‹è‰¯ã„è¡Œå‹•ã€ã«ç›®ã‚’å‘ã‘ã¦ã€è‡ªç¤¾ã®ä¾¡å€¤è¦³ã‚’ä½“ç¾ã—ã¦ã„ã‚‹ã“ã¨ã®æ„å‘³ä»˜ã‘ã‚’ã™ã‚‹ã“ã¨ã‹ã‚‰å–ã‚Šçµ„ã¿ã‚’é€²ã‚ã¦ãã ã•ã„ã€‚ä½“ç¾è¡Œå‹•ã®ç™ºè¦‹ã¨å¯è¦–åŒ–ã€è¡¨å½°åˆ¶åº¦ã«ã‚ˆã‚‹è‰¯ã„è¡Œå‹•ã®ç§°è³›ã€å®šæœŸçš„ãªå¯¾è©±ä¼šã®å®Ÿæ–½ã‚’è¡Œã„ã¾ã—ã‚‡ã†ã€‚'
                },
                A: {
                    improvement: '',
                    action: ''
                }
            },
            vi: {
                D: {
                    improvement: 'ãƒ–ãƒ©ãƒ³ãƒ‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨ã®ä¸æ•´åˆã€è¦–èªæ€§ãƒ»è¨˜æ†¶æ€§ã®ä¸è¶³ã€æ±ç”¨æ€§ãƒ»å±•é–‹æ€§ã®æ¬ å¦‚ã€ç«¶åˆä»–ç¤¾ã¨ã®å·®åˆ¥åŒ–ä¸è¶³ãŒã‚ã‚Šã¾ã™ã€‚ãƒ­ã‚´ã¯ä¼æ¥­ã®é¡”ã§ã™ã€‚ãƒ‡ã‚¶ã‚¤ãƒ³ãŒã‚¤ãƒã‚¤ãƒã ã¨ä¼šç¤¾ã®ä¿¡é ¼ã‚‚å¤±ã‚ã‚Œã¾ã™ã€‚ãƒ‡ã‚¶ã‚¤ãƒ³ã¨ã„ã†ã®ã¯ã€ã‚ã‹ã‚Šã‚„ã™ã„æŠ•è³‡ã§ã™ã€‚ã¾ãŸæ¡ç”¨è¦³ç‚¹ã§ã‚‚ã€ãƒ‡ã‚¶ã‚¤ãƒ³ãŒãƒ€ã‚µã„ä¼æ¥­ã¯ä¸åˆ©ã«ãªã‚Šã¾ã™ã€‚',
                    action: 'ãƒ–ãƒ©ãƒ³ãƒ‰æˆ¦ç•¥ã«åŸºã¥ã„ãŸãƒ­ã‚´ãƒªãƒ‹ãƒ¥ãƒ¼ã‚¢ãƒ«ã€æ§˜ã€…ãªãƒ¡ãƒ‡ã‚£ã‚¢ã§ã®è¦–èªæ€§ç¢ºä¿ã€æœ€å°ã‚µã‚¤ã‚ºã§ã®è­˜åˆ¥æ€§å‘ä¸Šã€ç¦æ­¢äº‹é …ã‚’å«ã‚€ãƒ­ã‚´ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ç­–å®šã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚ä¼æ¥­ç†å¿µã‚’ä½“ç¾ã™ã‚‹ãƒ­ã‚´ã‚’åˆ¶ä½œã—ã€ãƒ—ãƒ­ã®ãƒ‡ã‚¶ã‚¤ãƒŠãƒ¼ã«ä¾é ¼ã—ã€ç†å¿µã¨ã‚µãƒ¼ãƒ“ã‚¹ã‚’è¦–è¦šçš„ã«è¡¨ç¾ã§ãã‚‹ãƒ­ã‚´ã‚’é–‹ç™ºã—ã¾ã—ã‚‡ã†ã€‚'
                },
                C: {
                    improvement: 'å½¢å¼çš„ã§å®Ÿç”¨æ€§ã«æ¬ ã‘ã‚‹ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã€ç¤¾å†…å¤–ã§ã®æ´»ç”¨ä¸è¶³ã€æ›´æ–°ãƒ»ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ä¸å‚™ãŒã‚ã‚Šã¾ã™ã€‚ãƒ–ãƒ©ãƒ³ãƒ‰ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã¯å˜ãªã‚‹ãƒ‡ã‚¶ã‚¤ãƒ³ã®çµ±ä¸€ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ãƒ‡ã‚¶ã‚¤ãƒ³ãŒçµ±ä¸€ã•ã‚Œã‚‹ã¨ã„ã†ã“ã¨ã¯ã€ã€Œé¡§å®¢ãŒå—ã‘ã‚‹å°è±¡ãŒçµ±ä¸€ã•ã‚Œã‚‹ã€ã¨ã„ã†ã“ã¨ã§ã™ã€‚',
                    action: 'ãƒ–ãƒ©ãƒ³ãƒ‰ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã‚’ç­–å®šã—ã€å…¨ç¤¾ã§å¾¹åº•çš„ã«é‹ç”¨ã—ã¦ãã ã•ã„ã€‚ãƒ­ã‚´ã€è‰²ã€ãƒ•ã‚©ãƒ³ãƒˆã€ãƒˆãƒ¼ãƒ³ãªã©ã€ä¸€è²«ã—ãŸãƒ–ãƒ©ãƒ³ãƒ‰è¡¨ç¾ã®ãƒ«ãƒ¼ãƒ«ã‚’ä½œã‚Šã¾ã—ã‚‡ã†ã€‚ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆã§å®Ÿç”¨çš„ãªã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ä½œæˆã€ãƒ‡ã‚¸ã‚¿ãƒ«åŒ–ã«ã‚ˆã‚‹æ¤œç´¢æ€§å‘ä¸Šã€å®šæœŸçš„ãªæ›´æ–°ãƒ»ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆä½“åˆ¶ã®ç¢ºç«‹ãŒé‡è¦ã§ã™ã€‚'
                },
                B: {
                    improvement: 'æ™‚ä»£é…ã‚Œã®ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«è¡¨ç¾ã€ç«¶åˆã¨ã®å·®åˆ¥åŒ–ä¸è¶³ã€æ–°ã—ã„ãƒ¡ãƒ‡ã‚£ã‚¢ã¸ã®å¯¾å¿œä¸å‚™ãŒã‚ã‚Šã¾ã™ã€‚ãƒ–ãƒ©ãƒ³ãƒ‰ã¯æ™‚ä»£ã«å¿œã˜ã¦å¤‰åŒ–ã•ã›ã‚‹éƒ¨åˆ†ãŒã‚ã‚Šã¾ã™ã€‚é©åˆ‡ãªé »åº¦ã§é©åº¦ãªæ›´æ–°ãŒã•ã‚Œãªã‘ã‚Œã°ã€å¤ã„ä¼æ¥­ã¨ã„ã†å°è±¡ã‚’ä¸ãˆã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚',
                    action: 'ãƒ–ãƒ©ãƒ³ãƒ‰è¡¨ç¾ã®å®šæœŸçš„ãªè¦‹ç›´ã—ã¨æ”¹å–„ã‚’è¡Œã£ã¦ãã ã•ã„ã€‚æ™‚ä»£ã‚„å¸‚å ´ã®å¤‰åŒ–ã«åˆã‚ã›ã¦ã€é©åˆ‡ãªã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã—ã¾ã—ã‚‡ã†ã€‚å®šæœŸçš„ãªãƒ‡ã‚¶ã‚¤ãƒ³ç›£æŸ»ã®å®Ÿæ–½ã€ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æã¨é©ç”¨æ¤œè¨ã€A/Bãƒ†ã‚¹ãƒˆã«ã‚ˆã‚‹åŠ¹æœæ¸¬å®šã‚’è¡Œã£ã¦ãã ã•ã„ã€‚'
                },
                A: {
                    improvement: '',
                    action: ''
                }
            },
            bi: {
                D: {
                    improvement: 'æ±‚ã‚ã‚‹äººæåƒã¨ä¼æ¥­ç†å¿µã®ãƒŸã‚¹ãƒãƒƒãƒã€æ¡ç”¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ä¸€è²«æ€§ä¸è¶³ã€æ¡ç”¨ãƒ—ãƒ­ã‚»ã‚¹ã§ã®ç†å¿µè¨´æ±‚ä¸è¶³ãŒã‚ã‚Šã¾ã™ã€‚ä¼šç¤¾ã‚’ä½“ç¾ã™ã‚‹ã®ã¯äººã§ã™ã€‚ç†å¿µã«åˆã‚ãªã„äººã‚’æ¡ç”¨ã™ã‚‹ã¨ä¼æ¥­æ–‡åŒ–ãŒå´©ã‚Œã¾ã™ã€‚ãƒªãƒ¼ãƒ€ãƒ¼å±¤ãŒç†å¿µã‚’ä½“ç¾ã—ãªã‘ã‚Œã°ã€ãã®ä¼šç¤¾ã«æµ¸é€ã™ã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚',
                    action: 'æ¡ç”¨åŸºæº–ã«ç†å¿µã‚’æ˜ç¢ºã«åæ˜ ã•ã›ã¦ãã ã•ã„ã€‚äººæè¦ä»¶ã«ç†å¿µã¨ã®é©åˆæ€§ã‚’å…·ä½“çš„ã«ç¹”ã‚Šè¾¼ã¿ã€é¢æ¥ã§ã‚‚ç†å¿µã¸ã®å…±æ„Ÿåº¦ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚ä¼æ¥­ç†å¿µã«åŸºã¥ãäººæåƒã®æ˜ç¢ºåŒ–ã€æ¡ç”¨ã‚³ãƒ³ã‚»ãƒ—ãƒˆã®ç­–å®šã¨ç¤¾å†…å…±æœ‰ã€æ¡ç”¨ãƒ—ãƒ­ã‚»ã‚¹å…¨ä½“ã§ã®ä¸€è²«ã—ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒé‡è¦ã§ã™ã€‚'
                },
                C: {
                    improvement: 'ç†å¿µã¨çµ„ç¹”é‹å–¶ã®ä¹–é›¢ã€è©•ä¾¡åˆ¶åº¦ã¨ç†å¿µã®ä¸æ•´åˆã€éƒ¨é–€é–“ã§ã®ç†å¿µæµ¸é€åº¦æ ¼å·®ãŒã‚ã‚Šã¾ã™ã€‚çµå±€ã€ç†å¿µã¯æ²ã’ã‚‹ãŸã‚ã«ã‚ã‚‹ã®ã§ã¯ãªãã€ã€Œé©åˆ‡ãªè¡Œå‹•ã‚’ã—ã¦ä¼æ¥­æˆé•·ã™ã‚‹ã€ãŸã‚ã«ã‚ã‚Šã¾ã™ã€‚çµ„ç¹”æ§‹ç¯‰ã«æ´»ã‹ã™ã“ã¨ãŒãƒã‚¹ãƒˆã§ã™ã€‚',
                    action: 'ç¤¾å†…åˆ¶åº¦ãƒ»è©•ä¾¡ãƒ»å ±é…¬ã‚·ã‚¹ãƒ†ãƒ ã«ç†å¿µã‚’åæ˜ ã•ã›ã¦ãã ã•ã„ã€‚ç†å¿µã«æ²¿ã£ãŸè¡Œå‹•ãŒæ­£ã—ãè©•ä¾¡ã•ã‚Œã‚‹ä»•çµ„ã¿ã‚’æ§‹ç¯‰ã—ã¾ã—ã‚‡ã†ã€‚ç†å¿µã«åŸºã¥ãè¡Œå‹•æŒ‡é‡ã®ç­–å®šã€è©•ä¾¡åˆ¶åº¦ã¸ã®ç†å¿µè¦ç´ ã®çµ„ã¿è¾¼ã¿ã€æ˜‡é€²ãƒ»æ˜‡æ ¼åŸºæº–ã§ã®ç†å¿µä½“ç¾åº¦è€ƒæ…®ãŒå¿…è¦ã§ã™ã€‚'
                },
                B: {
                    improvement: 'ä¼æ¥­ã®é­…åŠ›ã‚„ä¾¡å€¤è¦³ã®ç™ºä¿¡ä¸è¶³ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆæ±‚è·è€…ã¸ã®è¨´æ±‚åŠ›ä¸è¶³ã€ç«¶åˆä»–ç¤¾ã¨ã®å·®åˆ¥åŒ–ä¸è¶³ãŒã‚ã‚Šã¾ã™ã€‚ã‚ˆãæ¯é›†å›£å½¢æˆã¨è¨€ã‚ã‚Œã¾ã™ãŒã€ç†å¿µã¨åˆã‚ãªã„äººãŒ100äºº1000äººã¨é›†ã¾ã£ã¦ã‚‚æ„å‘³ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ç†å¿µã¨åˆã†äººã‚’æ¡ç”¨ã™ã‚‹ã®ãŒã‚´ãƒ¼ãƒ«ã§ã™ã€‚',
                    action: 'æ¡ç”¨ã‚µã‚¤ãƒˆã‚„æ±‚äººç¥¨ã§ç†å¿µã‚’å¼·ãæ‰“ã¡å‡ºã—ã¦ãã ã•ã„ã€‚ç†å¿µã«å…±æ„Ÿã™ã‚‹äººæãŒé›†ã¾ã‚‹ã‚ˆã†ã€æ¡ç”¨åºƒå ±ã®å†…å®¹ã‚’è¦‹ç›´ã—ã¾ã—ã‚‡ã†ã€‚å¾“æ¥­å“¡ã®ãƒ–ãƒ©ãƒ³ãƒ‰ã‚¢ãƒ³ãƒã‚µãƒ€ãƒ¼åŒ–ã€SNSã‚’æ´»ç”¨ã—ãŸæƒ…å ±ç™ºä¿¡ã€ç¤¾å“¡ã‚¤ãƒ³ã‚¿ãƒ“ãƒ¥ãƒ¼ã«ã‚ˆã‚‹ãƒªã‚¢ãƒ«ãªå£°ã®ç™ºä¿¡ã‚’æ¨é€²ã—ã¦ãã ã•ã„ã€‚'
                },
                A: {
                    improvement: '',
                    action: ''
                }
            }
        };

        // å…¨ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å‹•çš„ç”Ÿæˆã™ã‚‹é–¢æ•°
        function generateAllPatterns() {
            const levels = ['A', 'B', 'C', 'D'];
            
            levels.forEach(mi => {
                levels.forEach(vi => {
                    levels.forEach(bi => {
                        const pattern = mi + vi + bi;
                        if (!PATTERN_RECOMMENDATIONS[pattern]) {
                            const criticalCount = [mi, vi, bi].filter(l => l === 'D').length;
                            const poorCount = [mi, vi, bi].filter(l => l === 'C').length;
                            
                            let urgency = 'low';
                            let description = '';
                            
                            if (criticalCount >= 2) {
                                urgency = 'critical';
                                description = 'è¤‡æ•°é ˜åŸŸã§æ©Ÿèƒ½ä¸å…¨ - ç·Šæ€¥æ”¹é©ãŒå¿…è¦';
                            } else if (criticalCount >= 1) {
                                urgency = 'high';
                                description = 'ä¸€éƒ¨é ˜åŸŸã§æ©Ÿèƒ½ä¸å…¨ - æ—©æ€¥ãªå¯¾å¿œãŒå¿…è¦';
                            } else if (poorCount >= 2) {
                                urgency = 'medium';
                                description = 'è¤‡æ•°é ˜åŸŸã§æ”¹å–„ãŒå¿…è¦';
                            } else if (poorCount >= 1) {
                                urgency = 'medium';
                                description = 'éƒ¨åˆ†çš„ãªæ”¹å–„ã§ç«¶äº‰åŠ›å‘ä¸Š';
                            } else {
                                urgency = 'low';
                                description = 'é«˜æ°´æº–ã®ç¶­æŒã¨æ›´ãªã‚‹å‘ä¸Š';
                            }

                            PATTERN_RECOMMENDATIONS[pattern] = {
                                description: description,
                                improvements: {
                                    mi: KNOWLEDGE_BASE.mi[mi].improvement,
                                    vi: KNOWLEDGE_BASE.vi[vi].improvement,
                                    bi: KNOWLEDGE_BASE.bi[bi].improvement,
                                    general: `MI:${mi}ãƒ¬ãƒ™ãƒ«ã€VI:${vi}ãƒ¬ãƒ™ãƒ«ã€BI:${bi}ãƒ¬ãƒ™ãƒ«ã®çŠ¶æ³ã§ã™ã€‚`
                                },
                                actions: {
                                    mi: KNOWLEDGE_BASE.mi[mi].action,
                                    vi: KNOWLEDGE_BASE.vi[vi].action,
                                    bi: KNOWLEDGE_BASE.bi[bi].action,
                                    general: 'å„é ˜åŸŸã®æ”¹å–„ã‚’æ®µéšçš„ã«å®Ÿè¡Œã—ã€çµ±åˆçš„ãªãƒ–ãƒ©ãƒ³ãƒ‰æˆ¦ç•¥ã‚’æ§‹ç¯‰ã—ã¦ãã ã•ã„ã€‚'
                                },
                                urgency: urgency
                            };
                        }
                    });
                });
            });
        }

        // ãƒ‘ã‚¿ãƒ¼ãƒ³ç”Ÿæˆã‚’å®Ÿè¡Œ
        generateAllPatterns();

        function updateProgress() {
            const totalQuestions = 12;
            const answeredQuestions = document.querySelectorAll('input[type="radio"]:checked').length;
            const progress = (answeredQuestions / totalQuestions) * 100;
            const remainingQuestions = totalQuestions - answeredQuestions;
            
            document.getElementById('fixedProgressFill').style.width = progress + '%';
            document.getElementById('progressPercentage').textContent = Math.round(progress) + '%';
            
            const questionsRemainingElement = document.getElementById('questionsRemaining');
            if (remainingQuestions === 0) {
                questionsRemainingElement.textContent = 'å®Œäº†ï¼';
                questionsRemainingElement.style.background = 'rgba(39, 174, 96, 0.2)';
                questionsRemainingElement.style.borderColor = 'rgba(39, 174, 96, 0.5)';
                questionsRemainingElement.style.color = '#2ecc71';
            } else {
                questionsRemainingElement.textContent = `æ®‹ã‚Š ${remainingQuestions}å•`;
            }
            
            const fixedProgress = document.getElementById('fixedProgress');
            if (answeredQuestions > 0) {
                fixedProgress.style.display = 'block';
            }
        }

        function getScoreLevel(score, category) {
            if (category === 'MI') {
                if (score >= 30) return 'A';
                if (score >= 20) return 'B';
                if (score >= 10) return 'C';
                return 'D';
            } else { // VI, BI
                if (score >= 26) return 'A';
                if (score >= 18) return 'B';
                if (score >= 8) return 'C';
                return 'D';
            }
        }

        function getLevel(score, maxScore) {
            const percentage = (score / maxScore) * 100;
            if (percentage >= 90) return { level: 'excellent', text: 'å„ªç§€' };
            if (percentage >= 70) return { level: 'good', text: 'è‰¯å¥½' };
            if (percentage >= 50) return { level: 'fair', text: 'æ™®é€š' };
            return { level: 'poor', text: 'è¦æ”¹å–„' };
        }

        function updateGradeDisplay(gradeElement, grade) {
            gradeElement.textContent = grade;
            gradeElement.className = `pattern-grade grade-${grade}`;
        }

        function updateDetailGradeDisplay(gradeElement, grade) {
            gradeElement.textContent = grade;
            gradeElement.className = `category-grade grade-${grade}`;
        }

        function calculateScores() {
            let miScore = 0, viScore = 0, biScore = 0;

            // MI scores
            for (let i = 1; i <= 4; i++) {
                const selected = document.querySelector('input[name="mi' + i + '"]:checked');
                if (selected) miScore += parseInt(selected.value);
            }

            // VI scores
            for (let i = 1; i <= 4; i++) {
                const selected = document.querySelector('input[name="vi' + i + '"]:checked');
                if (selected) viScore += parseInt(selected.value);
            }

            // BI scores
            for (let i = 1; i <= 4; i++) {
                const selected = document.querySelector('input[name="bi' + i + '"]:checked');
                if (selected) biScore += parseInt(selected.value);
            }

            return { miScore, viScore, biScore, totalScore: miScore + viScore + biScore };
        }

        function collectAnswers() {
            const answers = {};
            const questionNames = ['mi1', 'mi2', 'mi3', 'mi4', 'vi1', 'vi2', 'vi3', 'vi4', 'bi1', 'bi2', 'bi3', 'bi4'];
            
            questionNames.forEach(name => {
                const selected = document.querySelector(`input[name="${name}"]:checked`);
                if (selected) {
                    answers[name] = parseInt(selected.value);
                }
            });
            
            return answers;
        }

        function collectAnswerData() {
            const userName = document.getElementById('userName').value;
            const userCompany = document.getElementById('userCompany').value;
            const userEmail = document.getElementById('userEmail').value;
            const timestamp = new Date().toISOString();
            
            const answers = {};
            for (const [questionId, data] of Object.entries(questionData)) {
                const selectedOption = document.querySelector(`input[name="${questionId}"]:checked`);
                if (selectedOption) {
                    const optionIndex = getOptionIndex(questionId, parseInt(selectedOption.value));
                    const optionText = data.options[optionIndex];
                    answers[questionId] = {
                        category: data.category,
                        question: data.question,
                        answer: optionText,
                        score: parseInt(selectedOption.value)
                    };
                }
            }
            
            const scores = calculateScores();
            
            return {
                timestamp: timestamp,
                userName: userName,
                userCompany: userCompany,
                userEmail: userEmail,
                answers: answers,
                scores: scores
            };
        }

        function getOptionIndex(questionId, score) {
            // æ–°ã—ã„é…ç‚¹ã‚·ã‚¹ãƒ†ãƒ ã«åŸºã¥ãã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹è¨ˆç®—
            if (questionId.startsWith('mi')) {
                switch(score) {
                    case 0: return 0;
                    case 3: return 1;
                    case 5: return 2;
                    case 9: return 3;
                    default: return 0;
                }
            } else if (questionId.startsWith('vi') || questionId.startsWith('bi')) {
                switch(score) {
                    case 0: return 0;
                    case 3: return 1;
                    case 5: return 2;
                    case 8: return 3;
                    default: return 0;
                }
            }
            return 0;
        }

        async function sendToSpreadsheet(data) {
            if (!SPREADSHEET_URL || SPREADSHEET_URL.includes('YOUR_SCRIPT_ID')) {
                console.warn('ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆURLãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚');
                return { success: false, error: 'URLãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“' };
            }

            try {
                console.log('é€ä¿¡ãƒ‡ãƒ¼ã‚¿:', data);
                
                const response = await fetch(SPREADSHEET_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });

                console.log('ãƒ¬ã‚¹ãƒãƒ³ã‚¹çŠ¶æ…‹:', response.status);
                
                if (response.type === 'opaque') {
                    return { success: true, message: 'ãƒ‡ãƒ¼ã‚¿ãŒé€ä¿¡ã•ã‚Œã¾ã—ãŸ' };
                }
                
                if (response.ok) {
                    const result = await response.json();
                    console.log('ãƒ¬ã‚¹ãƒãƒ³ã‚¹å†…å®¹:', result);
                    return result;
                } else {
                    const errorText = await response.text();
                    console.error('HTTPã‚¨ãƒ©ãƒ¼:', response.status, errorText);
                    return { success: false, error: `HTTPã‚¨ãƒ©ãƒ¼: ${response.status}` };
                }
            } catch (error) {
                console.error('ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼:', error);
                
                try {
                    const img = new Image();
                    img.src = SPREADSHEET_URL + '?data=' + encodeURIComponent(JSON.stringify(data));
                    
                    return new Promise((resolve) => {
                        img.onload = () => resolve({ success: true, message: 'ãƒ‡ãƒ¼ã‚¿ãŒé€ä¿¡ã•ã‚Œã¾ã—ãŸï¼ˆãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰' });
                        img.onerror = () => resolve({ success: false, error: 'ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†ã‚‚å¤±æ•—ã—ã¾ã—ãŸ' });
                        
                        setTimeout(() => {
                            resolve({ success: true, message: 'ãƒ‡ãƒ¼ã‚¿ãŒé€ä¿¡ã•ã‚Œã¾ã—ãŸï¼ˆã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼‰' });
                        }, 3000);
                    });
                } catch (fallbackError) {
                    console.error('ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†ã‚‚å¤±æ•—:', fallbackError);
                    return { success: false, error: 'ã™ã¹ã¦ã®é€ä¿¡æ–¹æ³•ãŒå¤±æ•—ã—ã¾ã—ãŸ' };
                }
            }
        }

        function generateRecommendations(miLevel, viLevel, biLevel) {
            const pattern = miLevel + viLevel + biLevel;
            return PATTERN_RECOMMENDATIONS[pattern] || PATTERN_RECOMMENDATIONS['CCC'];
        }

        async function calculateResults() {
            const totalQuestions = 12;
            const answeredQuestions = document.querySelectorAll('input[type="radio"]:checked').length;
            const userName = document.getElementById('userName').value.trim();
            
            if (!userName) {
                alert('ãŠåå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚');
                document.getElementById('userName').focus();
                return;
            }
            
            if (answeredQuestions < totalQuestions) {
                document.getElementById('errorMessage').style.display = 'block';
                document.getElementById('errorMessage').textContent = `âŒ ã™ã¹ã¦ã®è³ªå•ã«å›ç­”ã—ã¦ãã ã•ã„ã€‚ï¼ˆ${answeredQuestions}/${totalQuestions}å•å›ç­”æ¸ˆã¿ï¼‰`;
                return;
            }

            const scores = calculateScores();
            const button = document.querySelector('.calculate-btn');
            const loading = document.getElementById('loading');
            const successMessage = document.getElementById('successMessage');
            const errorMessage = document.getElementById('errorMessage');

            button.disabled = true;
            loading.style.display = 'block';
            successMessage.style.display = 'none';
            errorMessage.style.display = 'none';

            // ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«ãƒ‡ãƒ¼ã‚¿é€ä¿¡
            const answerData = collectAnswerData();
            const result = await sendToSpreadsheet(answerData);

            button.disabled = false;
            loading.style.display = 'none';

            if (result.success) {
                successMessage.style.display = 'block';
                if (result.message) {
                    successMessage.textContent = 'âœ… ' + result.message;
                }
            } else {
                errorMessage.style.display = 'block';
                if (result.error) {
                    errorMessage.textContent = 'âŒ ' + result.error;
                }
            }

            // ã‚¹ã‚³ã‚¢è¡¨ç¤º
            document.getElementById('totalScore').textContent = scores.totalScore;
            document.getElementById('miScore').textContent = scores.miScore;
            document.getElementById('viScore').textContent = scores.viScore;
            document.getElementById('biScore').textContent = scores.biScore;

            // ãƒ¬ãƒ™ãƒ«åˆ¤å®š
            const miLevel = getScoreLevel(scores.miScore, 'MI');
            const viLevel = getScoreLevel(scores.viScore, 'VI');
            const biLevel = getScoreLevel(scores.biScore, 'BI');

            // ãƒ‘ã‚¿ãƒ¼ãƒ³è¡¨ç¤ºéƒ¨åˆ†ã®ã‚°ãƒ¬ãƒ¼ãƒ‰æ›´æ–°
            updateGradeDisplay(document.getElementById('miGrade'), miLevel);
            updateGradeDisplay(document.getElementById('viGrade'), viLevel);
            updateGradeDisplay(document.getElementById('biGrade'), biLevel);

            // è©³ç´°çµæœéƒ¨åˆ†ã®ã‚°ãƒ¬ãƒ¼ãƒ‰æ›´æ–°
            updateDetailGradeDisplay(document.getElementById('miDetailGrade'), miLevel);
            updateDetailGradeDisplay(document.getElementById('viDetailGrade'), viLevel);
            updateDetailGradeDisplay(document.getElementById('biDetailGrade'), biLevel);

            // ãƒ‘ã‚¿ãƒ¼ãƒ³æƒ…å ±è¡¨ç¤º
            const pattern = miLevel + viLevel + biLevel;
            document.getElementById('patternCode').textContent = pattern;
            document.getElementById('patternDescription').textContent = PATTERN_RECOMMENDATIONS[pattern].description;

            // å„ã‚«ãƒ†ã‚´ãƒªãƒ¬ãƒ™ãƒ«è¡¨ç¤º
            const miLevelInfo = getLevel(scores.miScore, 36);
            const viLevelInfo = getLevel(scores.viScore, 32);
            const biLevelInfo = getLevel(scores.biScore, 32);

            const miLevelElement = document.getElementById('miLevel');
            const viLevelElement = document.getElementById('viLevel');
            const biLevelElement = document.getElementById('biLevel');

            miLevelElement.textContent = miLevelInfo.text;
            miLevelElement.className = 'category-level level-' + miLevelInfo.level;

            viLevelElement.textContent = viLevelInfo.text;
            viLevelElement.className = 'category-level level-' + viLevelInfo.level;

            biLevelElement.textContent = biLevelInfo.text;
            biLevelElement.className = 'category-level level-' + biLevelInfo.level;

            // æ”¹å–„ææ¡ˆç”Ÿæˆ
            const recommendations = generateRecommendations(miLevel, viLevel, biLevel);
            const recommendationsList = document.getElementById('recommendationsList');
            recommendationsList.innerHTML = '';

            // å…¨ä½“çš„ãªæ”¹å–„ææ¡ˆï¼ˆã‚‚ã—ã‚ã‚‹å ´åˆï¼‰
            if (recommendations.improvements.general || recommendations.actions.general) {
                const generalSection = document.createElement('div');
                generalSection.className = `recommendation-item urgency-${recommendations.urgency}`;
                let generalContent = '';
                
                if (recommendations.improvements.general) {
                    generalContent += `<div style="margin-bottom: 15px;"><strong>ã€ç¾çŠ¶èªè­˜ã€‘</strong><br>${recommendations.improvements.general}</div>`;
                }
                if (recommendations.actions.general) {
                    generalContent += `<div><strong>ã€æ”¹å–„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã€‘</strong><br>${recommendations.actions.general}</div>`;
                }
                
                generalSection.innerHTML = `
                    <div class="recommendation-category">ç·åˆçš„ãªæ”¹å–„ææ¡ˆ</div>
                    <div class="recommendation-content">${generalContent}</div>
                `;
                recommendationsList.appendChild(generalSection);
            }

            // MIæ”¹å–„ææ¡ˆ
            if (recommendations.improvements.mi || recommendations.actions.mi) {
                const miSection = document.createElement('div');
                miSection.className = `recommendation-item urgency-${recommendations.urgency}`;
                let miContent = '';
                
                if (recommendations.improvements.mi) {
                    miContent += `<div style="margin-bottom: 15px;"><strong>ã€æ”¹å–„ç‚¹ã€‘</strong><br>${recommendations.improvements.mi}</div>`;
                }
                if (recommendations.actions.mi) {
                    miContent += `<div><strong>ã€å…·ä½“çš„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã€‘</strong><br>${recommendations.actions.mi}</div>`;
                }
                
                miSection.innerHTML = `
                    <div class="recommendation-category">MI - Mind Identityï¼ˆä¼æ¥­ç†å¿µãƒ»æ€æƒ³ãƒ»ä¾¡å€¤è¦³ï¼‰</div>
                    <div class="recommendation-content">${miContent}</div>
                `;
                recommendationsList.appendChild(miSection);
            }

            // VIæ”¹å–„ææ¡ˆ
            if (recommendations.improvements.vi || recommendations.actions.vi) {
                const viSection = document.createElement('div');
                viSection.className = `recommendation-item urgency-${recommendations.urgency}`;
                let viContent = '';
                
                if (recommendations.improvements.vi) {
                    viContent += `<div style="margin-bottom: 15px;"><strong>ã€æ”¹å–„ç‚¹ã€‘</strong><br>${recommendations.improvements.vi}</div>`;
                }
                if (recommendations.actions.vi) {
                    viContent += `<div><strong>ã€å…·ä½“çš„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã€‘</strong><br>${recommendations.actions.vi}</div>`;
                }
                
                viSection.innerHTML = `
                    <div class="recommendation-category">VI - Visual Identityï¼ˆãƒ­ã‚´ãƒ»ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ»ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«è¡¨ç¾ï¼‰</div>
                    <div class="recommendation-content">${viContent}</div>
                `;
                recommendationsList.appendChild(viSection);
            }

            // BIæ”¹å–„ææ¡ˆ
            if (recommendations.improvements.bi || recommendations.actions.bi) {
                const biSection = document.createElement('div');
                biSection.className = `recommendation-item urgency-${recommendations.urgency}`;
                let biContent = '';
                
                if (recommendations.improvements.bi) {
                    biContent += `<div style="margin-bottom: 15px;"><strong>ã€æ”¹å–„ç‚¹ã€‘</strong><br>${recommendations.improvements.bi}</div>`;
                }
                if (recommendations.actions.bi) {
                    biContent += `<div><strong>ã€å…·ä½“çš„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã€‘</strong><br>${recommendations.actions.bi}</div>`;
                }
                
                biSection.innerHTML = `
                    <div class="recommendation-category">BI - Behavior Identityï¼ˆè¡Œå‹•ãƒ»çµ„ç¹”ãƒ»äººæãƒ»æ–‡åŒ–ï¼‰</div>
                    <div class="recommendation-content">${biContent}</div>
                `;
                recommendationsList.appendChild(biSection);
            }

            document.getElementById('resultSection').style.display = 'block';
            document.getElementById('resultSection').scrollIntoView({ behavior: 'smooth' });
        }

        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('fixedProgress').style.display = 'none';
            
            const radioButtons = document.querySelectorAll('input[type="radio"]');
            radioButtons.forEach(function(radio) {
                radio.addEventListener('change', updateProgress);
            });

            const labels = document.querySelectorAll('.option');
            labels.forEach(function(label) {
                label.addEventListener('click', function() {
                    const parent = this.parentElement;
                    const siblings = parent.querySelectorAll('.option');
                    siblings.forEach(function(sibling) {
                        sibling.classList.remove('selected');
                    });
                    this.classList.add('selected');
                });
            });
        });
    </script>

</body>
</html>